version: 0.1.0
author: MohaFuzzingLabs
name: Unsafe Account Data Reallocation
severity: Medium
certainty: Low
description: Improper memory management during reallocation can lead to memory corruption, uninitialized memory access, or exploitation of sensitive data left in uninitialized memory regions. This can result in security vulnerabilities including potential account takeovers or data leakage.
rule: |
  for source, nodes in ast:
    try:
        realloc_sinks = nodes.find_chained_calls("realloc").exit_on_none()
        for sinks in realloc_sinks:
            for sink in sinks:
                if len(sink.args) == 2 and sink.args[1].get("lit", {}).get("bool", None) is False:
                    print(sink.parent.to_result())
    except:
        continue